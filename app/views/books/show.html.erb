
<%= render 'users/user_info', user: @book.user %>
  <!--ログインユーザ自身のbookを見ている場合は、ユーザー編集、他のユーザのbookを見ている場合は、マイページへのリンク　記述始め-->

  
  
  <!--投稿フォーム始め-->
  <%= render 'books/form', book: @new_book %>
  <!--投稿フォーム終わり-->





</div>
  <div class="books_show col-md-8 offset-md-1" >
    <h2>Book detail</h2>
      <table class="table table-striped table-hover">

      <tbody>
          <tr>
              <td>
               <%= link_to user_path(@book.user) do%>
                  <%= attachment_image_tag @book.user, :profile_image, :fill, 50, 50, format: 'jpeg', fallback: "no_image.jpg" %><br>
                  <%= @book.user.name%>
                <% end %>
              </td>   
              <td>
              <%= link_to book_path(@book) do %>
               <%= @book.title %>
              <% end %>
              </td>
              <td>
                <%= @book.body%>
              </td>
              <td>
                <%= render 'favorites/favorites', user: current_user, book: @book %>
              </td>
              <td>
                <p>コメント数:<%= @book.book_comments.count %></p>
              </td>
              <% if @book.user == current_user %>
              <td>
               <%= link_to "Edit", edit_book_path(@book), class: "btn btn-success" %>
              </td>
                
              <td>
                <%= link_to "Destroy", book_path(@book), method: :delete, class: "btn btn-danger", data: {confirm: "削除しますか？"} %>
              </td>
              <% end %>
          </tr>
      </tbody>
      </table>
      <!--↓コメントフォーム記述-->
        <% @book.book_comments.each do |comment|%>
      <div class ="comment mb-2" >
          <%= attachment_image_tag comment.user, :profile_image, :fill, 40, 40, format: 'jpeg', fallback: "no_image.jpg" %>
          <%= comment.comment %>
         <% if comment.user == current_user %>
          <%= link_to "Destroy", book_book_comment_path(comment.book, comment), method: :delete, class: "btn btn-danger" %>
         <% end %>
      </div>
        <% end %>
      <div class = "new-comment">
      <%= form_with(model:[@book, @book_comment], local: true) do |f| %>
        <%= f.text_area :comment %>
        <%= f.submit "投稿" %>
      <% end%>
      </div>
  </div>
</div>  
